# 参考资料

https://blog.csdn.net/Royalic/article/details/119999404


# 操作系统概述

## 定义

操作系统是系统软件，用于：控制管理计算机的软硬件，分配调度资源

## 基本功能

1、统一管理计算机资源：处理器、IO设备、存储器、文件资源  
2、对计算机资源进行抽象：数据读写、文件操作接口  
3、提供用户与计算机之间的接口：图形用户界面、命令形式  

## 特征

- [并行性](../about_Python/其他Updated.md)
- 并发性
- 共享性：资源可供多个并发程序共同使用
- 虚拟性：把一个物理实体转变为若干个逻辑实体
- [异步性](../about_Python/其他Updated.md)

> [!NOTE]
> 同时访问，指的是某资源被多个程序 **并发** 的访问，注意不是并行  
> 虚拟和异步的前提就是具有并发性  
> 时分复用：不同程序 **分时** 使用硬件资源，提高资源利用率  
> 空分复用：将物理磁盘虚拟为逻辑磁盘，例如电脑的C、D盘等  

## 中断处理

为什么需要中断处理？  
。。。。。。  

- 分类
    - 内中断：若当前执行的命令出现异常，CPU内部会发送该信号
    - 外中断：CPU外部有中断信号传入


# 进程管理

## 进程概述

进程是系统进行 **资源分配和调度** 的基本单位  
是程序独立运行的载体  
大幅提升操作系统的资源利用率  

> [!NOTE]
> 进程存在的唯一标识：进程控制块（PCB），记录进程的状态和运行的信息  

## 五状态模型

创建状态：准备好了PCB，但是缺少其他资源  
就绪状态：其他资源（内存、栈空间、堆空间等）也准备好了，就差CPU状态  
执行状态：进程获得CPU，正在执行  
阻塞状态：进程放弃CPU状态，阻塞的进程以队列的形式放置  
终止状态：系统清理、归还PCB状态  

## 进程同步

四原则：





# 作业管理

## 作业管理的进程调度

计算机通过决策决定哪个进程获得CPU使用权  

- 什么时候需要进程调度？
    - 主动放弃  
    进程正常终止或者发生异常终止；等待I/O的主动阻塞
    - 被动放弃  
    进程的时间片用完；就绪队列中出现了优先级更高的进程；I/O中断等紧急的事情

- 调度方式
    - 非抢占式：当前进程主动放弃CPU使用权
    - 抢占式：操作系统剥夺当前进程的CPU使用权

- 调度机制
    - 排队机制：就绪的进程按照一定方式排成队列
    - 委派机制：从队列中选择某进程，将CPU资源分配给它
    - 上下文切换机制：保存当前进程的上下文信息，放入主存中

- 调度算法
    - 先来先服务
    - 运行时间短的进程优先
    - 高优先权优先
    - 时间片轮转调度：按照先进先出的原则排列就绪进程，每次从队列取出一个进程并分配一个时间片执行

## 死锁

| 死锁 | 饥饿 | 死循环 |
| --- | --- | --- |
| 进程之间由于 **竞争资源** 或者 **彼此通信** 或者 **调度顺序不当** 所造成的阻塞现象 | 进程长期得不到资源 | 代码存在BUG |

### 怎样会导致死锁的产生？（死锁产生的必要条件）

- 互斥
- 保持资源
- 不可剥夺
- 环路等待

### 死锁处理策略

- 预防  
破坏上述条件中的一条或者多条
- 银行家算法  
检测当前剩余资源是否可以满足某进程的最大需求，可以的话就将其加入安全队列
- 撤销回退终止进程  


# 存储管理

## 内存的分配与回收

- 动态分区分配算法
    - 首次适应：每次从头部空间查找合适的内存区
    - 最佳适应：空闲区链表需按照容量大小排列，遍历查找最合适的内存区
    - 快速适应：？

内存回收的过程  
当回收区出现在空闲区的不同位置的时候，回收区和空闲区是直接合并，还是需要创建新的空闲节点？  
新的空闲区使用的地址是哪一个？  

## 段页式存储管理

用于离散地管理进程的逻辑空间  

段式存储，逻辑单位  
将进程逻辑空间分成若干段（不是等分）  
段的长度可以动态变化  

页式存储，物理单位  
为了合理利用空间  
将进程逻辑空间 **等分成** 若干页面  
页面大小一般是512B~8KB  

## 虚拟内存

对物理内存的扩充  

> [!NOTE]
> 局部性原理：CPU访问存储器时，所访问的存储单元都聚集在一个较小的连续区域中  

## Linux 的存储管理

Buddy 内存管理算法：解决内存外碎片的问题  

Swap 空间是Linux系统的交换空间，是磁盘的一个分区，在初始化系统时配置的  
当内存满时，系统会将一些内存交换至Swap空间  

| Swap 空间 | 虚拟内存 |
| --- | --- |
| 操作系统概念 | 进程概念 |
| 解决系统的物理内存不足问题 | 解决进程的物理内存不足问题 |


# 文件管理

## Linux 的文件系统

FAT
NTFS
EXT2/3/4


# 设备管理

## IO 设备

存储设备：内存、磁盘、U盘
交互IO设备：键盘、显示器、鼠标
字符设备：打印机、shell终端

IO设备的缓冲区：减少CPU处理IO请求的频率


# 线程池

线程池存放多个线程。CPU调度线程执行后不会销毁线程，而是将其放回线程池以重新利用
作用：减少线程频繁创建和销毁；业务创建和处理解耦

队列是存放元素的池

如何实现线程安全？可以结合队列实现
1、若有多个线程访问队列中的元素
使用锁保护队列，保证多个线程获取的串行
2、若队列为空时
阻塞，使用条件变量等待队列不为空

- Task 任务对象
实现任务具体的执行逻辑

- ProcessThread 任务处理线程
实现线程执行的逻辑和停止

- Pool 任务处理线程池
存放多个 ProcessThread，负责多个线程的启停，控制线程池的大小

- AsyncTask 异步任务处理
给任务标记（任务是否完成），获取任务结果

